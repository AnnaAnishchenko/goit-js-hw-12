{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCardTemplate = imgInfo => {\n  return `\n  <li class=\"gallery-card\">\n  <a href=\"${imgInfo.largeImageURL}\">\n     <img class=\"gallery-img\"\n      src=\"${imgInfo.webformatURL}\" \n      alt=\"${imgInfo.tags}\" />\n  </a>\n    <div class=\"info\">\n      <p><b>Likes:</b> ${imgInfo.likes}</p>\n      <p><b>Views:</b> ${imgInfo.views}</p>\n      <p><b>Comments:</b> ${imgInfo.comments}</p>\n      <p><b>Downloads:</b> ${imgInfo.downloads}</p>\n    </div>\n  </li>\n  `;\n};\n","// бібліотека axios\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '45552769-3540ba49dba2ab2d34c825df8';\n\nexport const fetchPhotos = (searchedQuery, page = 1, perPage = 15) => {\n  const axiosOptions = {\n    params: {\n      key: API_KEY,\n      q: searchedQuery,\n      orientation: 'horizontal',\n      per_page: perPage,\n      page: page,\n      safesearch: 'true',\n    },\n  };\n  return axios.get('', axiosOptions);\n};\n","//pixabay.com/api/\n\nimport { createGalleryCardTemplate } from './js/render-functions.js';\nimport { fetchPhotos } from './js/pixabay-api.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loaderEl = document.querySelector('.js-loader');\nconst loadMoreBtnEl = document.querySelector('.js-load-more');\n\n// початкова сторінка\nlet currentPage = 1;\nlet searchedValue = '';\nlet cardHeight = 0;\nlet totalHits = 0;\n\n// Створюємо екземпляр SimpleLightbox\nlet lightbox = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n//функції для показу  завантажувача\nconst showLoader = () => {\n  loaderEl.style.display = 'block';\n};\n\n//функції для приховування завантажувача\nconst hideLoader = () => {\n  loaderEl.style.display = 'none';\n};\n\nconst onSearchFormSubmit = async event => {\n  // відміна дії за замовчуванням\n  event.preventDefault();\n\n  currentPage = 1;\n\n  //значення елемента форми\n  const searchedValue = searchFormEl.elements.user_query.value.trim();\n\n  if (!searchedValue) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query!',\n    });\n    return;\n  }\n  // Очищення галереї перед новим пошуком\n  galleryEl.innerHTML = '';\n\n  loadMoreBtnEl.classList.add('is-hidden');\n  // викликаємо завантажувач\n  showLoader();\n\n  try {\n    // Запит на сервер\n    const response = await fetchPhotos(searchedValue, currentPage, 29);\n    console.log(response);\n\n    // Перевірка на відсутність результатів\n    if (response.data.hits.length === 0) {\n      iziToast.warning({\n        title: 'Warning',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n\n      searchFormEl.reset();\n      return;\n    }\n\n    // Перебираємо масив, додаємо всі елементи\n    const galleryCardsTemplate = response.data.hits\n      .map(imgDetails => createGalleryCardTemplate(imgDetails))\n      .join('');\n\n    // Додаємо в розмітку HTML\n    galleryEl.innerHTML = galleryCardsTemplate;\n\n    // Оновлюємо галерею SimpleLightbox\n    lightbox.refresh();\n\n    // Отримуємо висоту першої карточки галереї\n    const galleryCardEl = galleryEl.querySelector('li');\n\n    // Використання getBoundingClientRect для отримання висоти\n    cardHeight = galleryCardEl\n      ? galleryCardEl.getBoundingClientRect().height\n      : 0;\n\n    // зберігаємо загальну кількість результатів\n    totalHits = response.data.totalHits;\n    if (totalHits > currentPage * 29) {\n      loadMoreBtnEl.classList.remove('is-hidden');\n    }\n  } catch (err) {\n    console.log(err);\n    iziToast.error({\n      title: 'Error',\n      message: `An error occurred: ${err.message}`,\n    });\n  } finally {\n    // Приховуємо завантажувач після завершення запиту\n    hideLoader();\n  }\n};\n\n// завантаження\nconst onLoadMoreBtnClick = async event => {\n  currentPage++;\n  showLoader();\n\n  try {\n    const response = await fetchPhotos(searchedValue, currentPage, 29);\n\n    const galleryCardsTemplate = response.data.hits\n      .map(imgDetails => createGalleryCardTemplate(imgDetails))\n      .join('');\n\n    galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n    lightbox.refresh();\n\n    // Прокручуємо сторінку на дві висоти карточки галереї\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    // розрахунок загальної кількості сторінок\n    const totalPages = Math.ceil(totalHits / 29);\n\n    if (currentPage >= totalPages) {\n      loadMoreBtnEl.classList.add('is-hidden');\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: `An error occurred: ${err.message}`,\n    });\n  } finally {\n    hideLoader();\n  }\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n"],"names":["createGalleryCardTemplate","imgInfo","axios","API_KEY","fetchPhotos","searchedQuery","page","perPage","axiosOptions","searchFormEl","galleryEl","loaderEl","loadMoreBtnEl","currentPage","searchedValue","cardHeight","totalHits","lightbox","SimpleLightbox","showLoader","hideLoader","onSearchFormSubmit","event","iziToast","response","galleryCardsTemplate","imgDetails","galleryCardEl","err","onLoadMoreBtnClick","totalPages"],"mappings":"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"}